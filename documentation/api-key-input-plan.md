# Plan for Simplifying API Key Input

## Objective
Modify the web interface to allow users to input API key values as a comma-separated list, with the application automatically generating key names. The existing display of keys and the key selection dropdown for testing connections should be retained and updated to reflect the autogenerated key names.

## Revised Detailed Plan

1.  **Modify `index.html`**:
    *   **Keep existing API Key inputs**: Retain `<input type="text" id="api-keys">` (line 75) and `<input type="text" id="edit-api-keys">` (line 93).
    *   **Update labels**: Change the labels for these input fields to reflect the new comma-separated value format. For example, change "API Keys (format: key1=value1,key2=value2):" to "API Keys (comma-separated values):".
    *   **Retain and update display of keys in `loadProfiles`**:
        *   The `profileEl.innerHTML` should continue to use `JSON.stringify(profile.keys, null, 2)` to display the keys object.
        *   The `<select id="key-select-${profile.name}">` and its `Object.keys(profile.keys).map(...)` logic should be retained, as the autogenerated keys will populate this dropdown.

2.  **Modify `script` in `index.html`**:
    *   **Update `createBtn` event listener**:
        *   Get the value from `document.getElementById('api-keys').value`.
        *   Split the string by commas.
        *   For each value, trim whitespace.
        *   Construct the `keys` object. The key names will be autogenerated sequentially (e.g., `API_KEY_1`, `API_KEY_2`, `API_KEY_3`, etc.).
    *   **Update `startEditProfile` function**:
        *   Get the *values* from `profile.keys` (e.g., `Object.values(profile.keys)`).
        *   Join these values with commas to populate `document.getElementById('edit-api-keys').value`. The original key names are not needed for input, only for display in the dropdown.
    *   **Update `updateBtn` event listener**:
        *   Similar to `createBtn`, get the value from `document.getElementById('edit-api-keys').value`.
        *   Split the string by commas.
        *   For each value, trim whitespace.
        *   Construct the `keys` object with autogenerated names.
    *   **Retain `testProfile` function**: No changes are needed to the `testProfile` function itself, as it already takes `keyName` as an argument, which will be provided by the retained dropdown.

## Mermaid Diagram

```mermaid
graph TD
    A[User Request: Simplify API Key Input] --> B{Analyze Current Implementation};
    B --> C1[index.html: Single API Key Input Fields];
    B --> C2[JavaScript: Parses "key=value" string];
    B --> C3[profiles.json: Keys have arbitrary names];

    C1 --> D[Modify HTML: Keep single input, update labels];
    C2 --> E[Modify JS: Parse comma-separated values];
    C2 --> E2[Modify JS: Autogenerate key names (e.g., API_KEY_1)];
    C3 --> F[User Confirmed: Autogenerate key names is acceptable];
    F --> G[User Clarified: Retain key selection dropdown];

    D --> H[Update loadProfiles: Retain JSON.stringify display and key selection dropdown];
    E --> I[Update createBtn logic to parse comma-separated values and autogenerate keys];
    E --> J[Update startEditProfile to format ONLY values as comma-separated string];
    E --> K[Update updateBtn logic to parse comma-separated values and autogenerate keys];
    G --> L[Retain testProfile functionality];

    H & I & J & K & L --> M[Test and Verify];